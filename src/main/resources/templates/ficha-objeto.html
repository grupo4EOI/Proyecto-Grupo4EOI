<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <title>Rese√±as.com</title>
    <link crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css"
          integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet">
    <link rel="stylesheet" th:href="@{/css/style-ficha-objeto.css}">

</head>
<body class="d-flex flex-column min-vh-100">
<!--Header-->
<!--Donde pone rese√±as.com, notificaciones y perfil, deber√≠a ir la imagen correspondiente como en la imagen que
        pas√≥ Almudena por discord, pero para no liarla con las rutas, vamos a dejarlo ahora mismo as√≠ y m√°s
        adelante se cambia-->

<nav class="navbar navbar-expand-lg bg-custom">
    <div class="container-fluid">
        <a class="navbar-brand text-white" href="#">Rese√±as.com</a>
        <button aria-controls="menu" aria-expanded="false" aria-label="cabecera" class="navbar-toggler"
                data-bs-target="#menu" data-bs-toggle="collapse" type="button">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="menu">
            <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                <li class="nav-item">
                    <a class="nav-link text-white" href="#">Inicio</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link text-white" href="#">Cine</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link text-white" href="#">Series</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link text-white" href="#">Videojuegos</a>
                </li>

            </ul>
            <form class="d-flex me-auto" id="barraDeBusqueda" role="search">
                <input aria-label="Search" class="form-control me-2" placeholder="Buscar contenido" type="search">
                <button class="btn btn-outline-light text-white" type="submit">Buscar</button>
            </form>
            <ul class="navbar-nav ms-auto mb-2 mb-lg-0">
                <li class="nav-item">
                    <a class="nav-link active text-white" href="#"><i class="bi bi-bell"></i></a>
                </li>
                <li class="nav-item">
                    <a class="nav-link text-white" href="#"><i class="bi bi-person"></i></a>
                </li>
                <li class="nav-item">
                    <a class="nav-link text-white" href="#">Cerrar sesi√≥n</a>
                </li>
            </ul>
        </div>
    </div>
</nav>

<!--Contenido de la p√°gina-->
<div class="container" id="body-pagina">

    <!--  Primera fila: datos del objeto + botones asociados al objeto / usuario -->
    <div class="row gx-0">

        <!-- Titular y datos: a√±o publicaci√≥n y duraci√≥n -->
        <div class="col-12 mt-4"><h2 th:text="${fichaObjeto.titulo()}"></h2></div>
        <div class="col-12 mt-2"><p th:text="${fichaObjeto.fechaYDuracion()}"></p></div>

        <!-- Imagen objeto -->
        <div class="image-container-ext">
            <div class="image-container col-xxl-3 col-xl-5 col-lg-12">
                <img class="img-fluid" th:alt="'Cartel de ' + ${fichaObjeto.tipo()} + ': ' + ${fichaObjeto.titulo()}"
                     th:src="${fichaObjeto.imagenUrl()}">
                <!-- Boton para acceder al trailer de una pel√≠cula / serie / videojuego -->
                <button
                        class="trailer-button btn btn-primary video-btn"
                        data-bs-target="#modal-trailer"
                        data-bs-toggle="modal"
                        th:data-src="${fichaObjeto.trailerUrl()}"
                        type="button">
                    <i class="bi bi-play-circle me-2"></i>Ver trailer
                </button>
                <!-- Modal que aparecer√° en caso de que se clique el bot√≥n de trailer -->
                <div aria-hidden="true" aria-labelledby="modal-trailer" class="modal fade" id="modal-trailer" role="dialog"
                     tabindex="-1">
                    <div class="modal-dialog" role="document">
                        <div class="modal-content">
                            <div class="modal-body">
                                <button aria-label="Cerrar" class="btn-close" data-bs-dismiss="modal"
                                        type="button"></button>
                                <div class="ratio ratio-16x9">
                                    <iframe allow="autoplay" class="embed-responsive-item" id="video"
                                            th:src="${fichaObjeto.trailerUrl()}"></iframe>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>  <!-- Fin imagen del objeto -->
        </div>

        <!-- Columna informaci√≥n objeto -->
        <div class="col-xxl-6 col-xl-7 col-lg-12 pe-xxl-4">
            <div class="container">
                <div class="row d-flex flex-column gap-2">
                    <div class="col-12">
                        <p class="mb-2" th:text="'Puntuaci√≥n: ' + ${fichaObjeto.puntuacion()} + ' / 5'"></p>
                    </div>
                    <div class="col-12">
                        <p th:text="'Numero total rese√±as: ' + ${fichaObjeto.numeroResenas()}"></p>
                    </div>
                    <hr class="hr mt-0">
                    <div class="col-12 d-flex align-items-center gap-2">
                        <span><b>Direcci√≥n:</b></span>
                        <div th:each="director, iterStat : ${fichaObjeto.directores()}">
                            <div class="etiqueta px-2" data-bs-toggle="modal" th:data-bs-target="'#modalDirector-' + ${iterStat.index}"><i class="bi bi-person me-2"></i>
                                <span th:text="${director.nombreCompleto()}"></span>
                            </div>
                            <div class="modal fade" th:id="'modalDirector-' + ${iterStat.index}" tabindex="-1" aria-labelledby="modalDirectorLabel" aria-hidden="true">
                                <div class="modal-dialog modal-persona-dialog">
                                    <div class="modal-content modal-persona-content">
                                        <div class="modal-header modal-persona-header">
                                            <h3 th:text="${director.nombreCompleto()}" class="modal-title modal-persona-title fs-5" id="modalDirectorLabel"></h3>
                                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                        </div>
                                        <div class="modal-body modal-persona-body d-flex flex-column gap-2">
                                            <img th:src="${director.fotoUrl()}" class="img-fluid align-self-center modal-persona-img" alt="Responsive image">
                                            <p th:text="${director.biografia()}"></p>
                                        </div>
                                        <div class="modal-persona-footer">
                                            <button type="button" class="btn btn-primary" data-bs-dismiss="modal">Cerrar</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-12 d-flex align-items-center gap-2">
                      <span><b>Reparto:</b> </span>
                      <div th:each="actor, iterStat : ${fichaObjeto.actores()}">
                          <div class="etiqueta px-2" data-bs-toggle="modal" th:data-bs-target="'#modalActor-' + ${iterStat.index}"><i class="bi bi-person me-2"></i>
                              <span th:text="${actor.nombreCompleto()}"></span>
                          </div>
                          <div class="modal fade" th:id="'modalActor-' + ${iterStat.index}" tabindex="-1" aria-labelledby="modalActorLabel" aria-hidden="true">
                              <div class="modal-dialog modal-persona-dialog">
                                  <div class="modal-content modal-persona-content">
                                      <div class="modal-header modal-persona-header">
                                          <h3 th:text="${actor.nombreCompleto()}" class="modal-title modal-persona-title fs-5" id="modalActorLabel"></h3>
                                          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                      </div>
                                      <div class="modal-body modal-persona-body d-flex flex-column gap-2">
                                          <img th:src="${actor.fotoUrl()}" class="img-fluid align-self-center modal-persona-img" alt="Responsive image">
                                          <p th:text="${actor.biografia()}"></p>
                                      </div>
                                      <div class="modal-persona-footer">
                                          <button type="button" class="btn btn-primary" data-bs-dismiss="modal">Cerrar</button>
                                      </div>
                                  </div>
                              </div>
                          </div>
                      </div>
                    </div>
                    <div class="col-12 mt-2 d-inline-flex flex-wrap">
                        <p><b>Descripci√≥n:</b>
                            <span th:text="${fichaObjeto.descripcion()}"></span>
                        </p>
                    </div>
                    <div class="col-12 mt-0 d-flex flex-wrap align-items-center gap-2">
                        <span><b>G√©neros:</b> </span>
                        <div class="etiqueta px-3" th:each="genero : ${fichaObjeto.generos()}"
                             th:text="${genero}"></div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-xxl-3 col-xl-12 col-lg-12 ps-xxl-4" id="columna-derecha">
            <div class="etiqueta px-3 mb-2 mx-1" data-bs-toggle="modal" data-bs-target="#modalResena">
                <i class="bi bi-star mx-2"></i>
                A√±adir rese√±a
            </div>

            <!-- Modal -->
            <!-- Modal -->
            <!--
            <div class="modal fade" id="modalResena" tabindex="-1" aria-labelledby="reviewModalLabel" aria-hidden="true">
                <div class="modal-dialog modal-dialog-centered">
                    <div class="modal-content border-0 shadow-lg rounded-4 overflow-hidden">


                        <div class="modal-header bg-gradient text-white py-3">
                            <h5 class="modal-title fw-bold" id="reviewModalLabel">üìù A√±adir Rese√±a</h5>
                            <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Cerrar"></button>
                        </div>


                        <form
                              method="post">

                            <div class="modal-body px-4 py-3">


                                <div class="mb-3">
                                    <label for="rating" class="form-label">Puntuaci√≥n (0.0 ‚Äì 5.0)</label>
                                    <input type="number"
                                           class="form-control rounded-pill"
                                           id="rating"
                                           th:field="*{puntuacion}"
                                           min="0" max="5"
                                           step="0.1"
                                           placeholder="Ej. 3.5" required />
                                </div>


                                <div class="form-floating mb-3">
            <textarea class="form-control rounded-3"
                      placeholder="Escribe tu rese√±a..."
                      id="text"
                      style="height: 120px"
                      th:field="*{contenido}"
                      required></textarea>
                                    <label for="text">Escribe tu rese√±a...</label>
                                </div>
                            </div>


                            <div class="modal-footer bg-light border-0 px-4 py-3">
                                <button type="button" class="btn btn-outline-secondary rounded-pill" data-bs-dismiss="modal">
                                    Cancelar
                                </button>
                                <button type="submit" class="btn btn-primary rounded-pill px-4">
                                    Publicar
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
            -->


            <div class="etiqueta px-3 mb-2 mx-1">
                <i class="bi bi-pencil mx-2"></i>
                A√±adir publicaci√≥n
            </div>

            <div class="etiqueta px-3 mb-2 mx-1">
                <i class="bi bi-heart mx-2"></i>
                A√±adir a lista de favoritos
            </div>

            <div class="etiqueta px-3 mb-2 mx-1">
                <i class="bi bi-bar-chart mx-2"></i>
                A√±ade tu progreso
            </div>
            <div class="etiqueta px-3 mb-2 mx-1">
                <i class="bi bi-people mx-2"></i>
                Unirte a la comunidad
            </div>
        </div>
    </div>
    <hr class="hr mt-3">
    <!-- Apartado rese√±as -->
    <h3 class="col-12"><b>Rese√±as</b></h3>
    <div class="row mx-3 my-3 gx-0" th:each="resena, iterStat : ${fichaObjeto.resenas()}">
        <div class="etiqueta px-2 mb-2 me-3 w-auto" th:text="'@' + ${resena.autor().nombreUsuario()}"><i
                class="bi bi-person me-2"></i>@MrRese√±ador
        </div>
        <div class="etiqueta px-2 mb-2 w-auto me-3 bg-danger text-white">Notificar abuso</div>
        <div class="etiqueta px-2 mb-2 w-auto bg-danger text-white">Notificar spoiler</div>
        <div class="container" id="review">
            <div class="row">
                <div class="col-12 mb-2 mt-1">Puntuaci√≥n: <span th:text="${resena.puntuacion()} + ' / 5'"></span>
                </div>
                <div class="col-12 mb-2">
                    <b>T√≠tulo de la rese√±a: </b><span th:text="${resena.titulo()}"></span>
                </div>
                <div class="col-12 mb-1">
                    <b>Contenido de la rese√±a: </b><span th:text="${resena.contenido()}"></span>
                </div>
            </div>
        </div>
        <div class="etiqueta px-2 mt-2 me-3 w-auto"><i class="bi bi-heart"></i> Me gusta</div>
        <div class="etiqueta px-2 mt-2 me-3 w-auto" data-bs-toggle="collapse" th:data-bs-target="'#comentarios-' + ${iterStat.index}" aria-expanded="false"><i class="bi bi-chat"></i> Comentarios</div>
        <div class="row collapse mt-3 ms-4 me-2 pt-3 comentarios" th:each="comentario : ${resena.comentariosResena()}" th:id="'comentarios-' + ${iterStat.index}">
            <div class="etiqueta px-2 mb-2 me-3 w-auto" th:text="'@' + ${comentario.usuario().nombreUsuario()}"><i
                    class="bi bi-person me-2"></i>@MrRese√±ador
            </div>
            <div class="etiqueta px-2 mb-2 w-auto me-3 bg-danger text-white">Notificar abuso</div>
            <div class="etiqueta px-2 mb-2 w-auto bg-danger text-white">Notificar spoiler</div>
            <p th:text="${comentario.contenido()}"></p>
        </div>
    </div>
    <hr class="hr mt-3">

    <!-- Apartado publicaciones-->
    <h3 class="col-12"><b>Publicaciones</b></h3>
    <div class="row mx-3 my-3 gx-0" th:each="publicacion : ${fichaObjeto.publicaciones()}">
        <div class="etiqueta px-2 mb-2 me-3 w-auto" th:text="'@' + ${publicacion.usuario().nombreUsuario()}"><i class="bi bi-person me-2"></i></div>
        <div class="etiqueta px-2 mb-2 w-auto me-3 bg-danger text-white">Notificar abuso</div>
        <div class="etiqueta px-2 mb-2 w-auto bg-danger text-white">Notificar spoiler</div>
        <div class="container" id="publicacion" >
            <div class="row">
                <div class="col-12 mt-1 mb-2">
                    <b>T√≠tulo de la publicaci√≥n:</b> <span th:text="${publicacion.titulo()}"></span>
                </div>
                <div class="col-12 mb-1" th:text="${publicacion.contenido()}"></div>
            </div>
        </div>
        <div class="etiqueta px-2 mt-2 me-3 w-auto"><i class="bi bi-heart"></i> Me gusta</div>
    </div>

</div>

<!-- Parte de JavaScript para el modal -->
<script src="/js/trailer.js"></script>

<!--Footer-->
<footer class="bg-custom text-center py-3 mt-auto">
    <div class="container">
        <div class="row">
            <div class="col-md-4">
                <h5>Redes Sociales</h5>
                <ul class="list-unstyled">
                    <li><a class="redes" href="#"><i class="fa fa-facebook"></i> Facebook</a></li>
                    <li><a class="redes" href="#"><i class="fa fa-twitter"></i> Twitter</a></li>
                    <li><a class="redes" href="#"><i class="fa fa-instagram"></i> Instagram</a></li>
                    <li><a class="redes" href="#"><i class="fa fa-youtube"></i> YouTube</a></li>
                </ul>
            </div>
            <div class="col-md-4">
                <h5>Soporte</h5>
                <ul class="list-unstyled">
                    <li><a class="soporte" href="#">FAQ</a></li>
                    <li><a class="soporte" href="#">Contacto</a></li>
                    <li><a class="soporte" href="#">Soporte T√©cnico</a></li>
                </ul>
            </div>
            <div class="col-md-4">
                <h5>Legal</h5>
                <ul class="list-unstyled">
                    <li><a class="legal" href="#">T√©rminos y Condiciones</a></li>
                    <li><a class="legal" href="#">Pol√≠tica de Privacidad</a></li>
                </ul>
            </div>
        </div>
        <p>&copy; <a class="text-decoration-none" href="#">Rese√±as.com</a>. Todos los derechos reservados 2025.</p>
    </div>
</footer>

<script crossorigin="anonymous"
        integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4"
        src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>

</body>

</html>